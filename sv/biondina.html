<!doctype html>
<html lang="it" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>San Valentino ğŸ’•</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&amp;family=Quicksand:wght@400;500;600&amp;display=swap" rel="stylesheet">
  <style>
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }
    @keyframes pulse-heart {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    @keyframes confetti-fall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100%) rotate(720deg); opacity: 0; }
    }
    .float-animation {
      animation: float 3s ease-in-out infinite;
    }
    .heart-pulse {
      animation: pulse-heart 1.5s ease-in-out infinite;
    }
    .sparkle {
      animation: sparkle 2s ease-in-out infinite;
    }
    .confetti {
      animation: confetti-fall 3s ease-out forwards;
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-auto">
  <div id="app-wrapper" class="w-full h-full"><!-- Pagina Domanda -->
   <div id="question-page" class="min-h-full w-full flex flex-col items-center justify-center p-6 relative overflow-hidden" style="background: linear-gradient(135deg, #fff5f5 0%, #ffe4e6 50%, #fecdd3 100%);"><!-- Cuori decorativi fluttuanti -->
    <div class="absolute inset-0 pointer-events-none overflow-hidden">
     <div class="absolute top-[10%] left-[10%] text-4xl float-animation" style="animation-delay: 0s;">
      ğŸ’•
     </div>
     <div class="absolute top-[20%] right-[15%] text-3xl float-animation" style="animation-delay: 0.5s;">
      ğŸ’—
     </div>
     <div class="absolute bottom-[30%] left-[5%] text-2xl float-animation" style="animation-delay: 1s;">
      âœ¨
     </div>
     <div class="absolute bottom-[20%] right-[10%] text-3xl float-animation" style="animation-delay: 1.5s;">
      ğŸ’–
     </div>
     <div class="absolute top-[50%] left-[3%] text-2xl float-animation" style="animation-delay: 2s;">
      ğŸŒ¸
     </div>
     <div class="absolute top-[40%] right-[5%] text-2xl float-animation" style="animation-delay: 0.3s;">
      ğŸ’
     </div>
    </div><!-- Contenuto principale -->
    <div class="relative z-10 text-center max-w-md mx-auto"><!-- Cuore grande animato -->
     <div class="text-8xl mb-8 heart-pulse">
      â¤ï¸
     </div><!-- Domanda -->
     <h1 id="main-question" class="text-3xl md:text-4xl font-bold mb-12 leading-tight" style="font-family: 'Playfair Display', serif; color: #be123c;">Sei il mio San Valentino?</h1><!-- Pulsanti -->
     <div class="flex flex-col sm:flex-row gap-4 justify-center items-center"><!-- Pulsante SÃ¬ --> <button id="yes-btn" class="px-12 py-4 text-xl font-semibold rounded-full shadow-lg transform transition-all duration-300 hover:scale-110 hover:shadow-xl active:scale-95" style="font-family: 'Quicksand', sans-serif; background: linear-gradient(135deg, #f43f5e 0%, #e11d48 100%); color: white;"> SÃ¬! ğŸ’• </button> <!-- Pulsante No (scappa!) --> <button id="no-btn" class="px-12 py-4 text-xl font-semibold rounded-full shadow-lg transition-all duration-150" style="font-family: 'Quicksand', sans-serif; background: linear-gradient(135deg, #fda4af 0%, #fb7185 100%); color: white;"> No ğŸ˜… </button>
     </div><!-- Messaggio scherzoso -->
     <p id="chase-message" class="mt-8 text-sm opacity-0 transition-opacity duration-300" style="font-family: 'Quicksand', sans-serif; color: #be123c;">Hehe, non puoi scappare! ğŸ˜ğŸ’•</p>
    </div>
   </div><!-- Pagina Successo -->
   <div id="success-page" class="min-h-full w-full flex-col items-center justify-center p-6 relative overflow-hidden hidden" style="background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 50%, #fbcfe8 100%);"><!-- Pulsante segreto --> <button id="secret-btn" class="absolute top-4 right-4 w-10 h-10 rounded-full opacity-10 hover:opacity-30 transition-opacity duration-300 z-20" style="background: transparent;" aria-label="Segreto"> <span class="text-xs" style="color: #be123c;">â€¢</span> </button> <!-- Container confetti -->
    <div id="confetti-container" class="absolute inset-0 pointer-events-none overflow-hidden z-10"></div><!-- Cuori decorativi -->
    <div class="absolute inset-0 pointer-events-none overflow-hidden">
     <div class="absolute top-[5%] left-[20%] text-5xl float-animation">
      ğŸ’–
     </div>
     <div class="absolute top-[15%] right-[20%] text-4xl float-animation" style="animation-delay: 0.3s;">
      ğŸ’•
     </div>
     <div class="absolute bottom-[25%] left-[10%] text-3xl float-animation" style="animation-delay: 0.6s;">
      âœ¨
     </div>
     <div class="absolute bottom-[15%] right-[15%] text-4xl float-animation" style="animation-delay: 0.9s;">
      ğŸ’—
     </div>
     <div class="absolute top-[45%] left-[5%] text-3xl float-animation" style="animation-delay: 1.2s;">
      ğŸŒ¹
     </div>
     <div class="absolute top-[35%] right-[8%] text-3xl float-animation" style="animation-delay: 0.5s;">
      ğŸ’
     </div>
    </div><!-- Contenuto successo -->
    <div class="relative z-10 text-center max-w-md mx-auto flex flex-col items-center justify-center min-h-full py-12"><!-- Cuori che esplodono -->
     <div class="text-7xl mb-6 heart-pulse">
      ğŸ¥°
     </div><!-- Titolo -->
     <h1 id="success-title" class="text-4xl md:text-5xl font-bold mb-6" style="font-family: 'Playfair Display', serif; color: #be123c;">Yeee! ğŸ’•</h1><!-- Messaggio principale -->
     <p id="success-message" class="text-xl mb-4" style="font-family: 'Quicksand', sans-serif; color: #9f1239;">Sapevo che avresti detto sÃ¬!</p><!-- Card cena -->
     <div class="rounded-3xl p-8 mt-4 shadow-xl" style="background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px);">
      <div class="text-5xl mb-4">
       ğŸğŸ•¯ï¸ğŸ·
      </div>
      <p id="dinner-message" class="text-lg font-medium" style="font-family: 'Quicksand', sans-serif; color: #be123c;">Preparati... stasera andiamo a cena fuori! Ti voglio tutta allagante!</p>
      <div class="mt-4 text-3xl"><span class="sparkle inline-block" style="animation-delay: 0s;">âœ¨</span> <span class="sparkle inline-block" style="animation-delay: 0.3s;">ğŸ’«</span> <span class="sparkle inline-block" style="animation-delay: 0.6s;">âœ¨</span>
      </div>
     </div><!-- Messaggio segreto (nascosto inizialmente) -->
     <div id="secret-message" class="mt-8 p-4 rounded-2xl hidden" style="background: linear-gradient(135deg, #fecdd3 0%, #fda4af 100%);">
      <p class="text-lg font-semibold" style="font-family: 'Quicksand', sans-serif; color: #9f1239;">...e poi me la dai ğŸ˜ğŸ”¥</p>
     </div><!-- Cuore finale -->
     <div class="mt-8 text-6xl heart-pulse">
      â¤ï¸
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      main_question: "Sei il mio San Valentino?",
      success_title: "Yeee! ğŸ’•",
      success_message: "Sapevo che avresti detto sÃ¬!",
      dinner_message: "Preparati... stasera andiamo a cena fuori! ..... e ti voglio tutta allagante!!",
      primary_color: "#be123c",
      secondary_color: "#f43f5e",
      background_color: "#fff5f5",
      text_color: "#9f1239",
      accent_color: "#fda4af",
      font_family: "Playfair Display",
      font_size: 16
    };

    let config = { ...defaultConfig };

    // Array di messaggi casuali per il pulsante No
    const noMessages = [
      'No ğŸ˜…',
      'Dai... ğŸ¥º',
      'Sicuro? ğŸ˜¢',
      'Pensaci! ğŸ’”',
      'Per favore? ğŸ¥¹',
      'ğŸ˜­ğŸ˜­ğŸ˜­',
      'Veramente? ğŸ’”',
      'Riflettici! ğŸ¤”',
      'Dai dai! ğŸ™',
      'Non mi dire no! ğŸ˜­',
      'Cambia idea! ğŸ’•',
      'Su, non scherzare! ğŸ˜¢',
      'Mi spezzi il cuore! ğŸ’”',
      'Allora... ğŸ¥²',
      'Ancora no? ğŸ˜­',
      'Una chance? ğŸ¥º',
      'Io ti amo! ğŸ’•',
      'Non cedere! ğŸ˜…',
      'Ci penso ancora! ğŸ¤”',
      'Ma dai! ğŸ€'
    ];

    // Elementi DOM
    const questionPage = document.getElementById('question-page');
    const successPage = document.getElementById('success-page');
    const noBtn = document.getElementById('no-btn');
    const yesBtn = document.getElementById('yes-btn');
    const chaseMessage = document.getElementById('chase-message');
    const secretBtn = document.getElementById('secret-btn');
    const secretMessage = document.getElementById('secret-message');
    const confettiContainer = document.getElementById('confetti-container');

    // Contatore tentativi di click su No
    let noAttempts = 0;
    let usedMessages = new Set();

    // Funzione per ottenere un messaggio casuale non usato di recente
    function getRandomNoMessage() {
      let availableMessages = noMessages.filter(msg => !usedMessages.has(msg));
      
      // Se tutti i messaggi sono stati usati, resetta
      if (availableMessages.length === 0) {
        usedMessages.clear();
        availableMessages = noMessages;
      }

      const randomIndex = Math.floor(Math.random() * availableMessages.length);
      const message = availableMessages[randomIndex];
      usedMessages.add(message);

      return message;
    }

    // Funzione per far scappare il pulsante No
    function escapeNoButton(e) {
      noAttempts++;
      
      const btn = noBtn;
      const parent = btn.parentElement;
      const parentRect = parent.getBoundingClientRect();
      const btnRect = btn.getBoundingClientRect();
      
      // Calcola nuova posizione casuale
      const maxX = window.innerWidth - btnRect.width - 20;
      const maxY = window.innerHeight - btnRect.height - 20;
      
      let newX = Math.random() * maxX;
      let newY = Math.random() * maxY;
      
      // Assicurati che sia lontano dal cursore
      const mouseX = e.clientX || e.touches?.[0]?.clientX || 0;
      const mouseY = e.clientY || e.touches?.[0]?.clientY || 0;
      
      const distance = Math.sqrt(Math.pow(newX - mouseX, 2) + Math.pow(newY - mouseY, 2));
      if (distance < 150) {
        newX = mouseX > window.innerWidth / 2 ? 20 : maxX;
        newY = mouseY > window.innerHeight / 2 ? 20 : maxY;
      }

      // Applica posizione assoluta
      btn.style.position = 'fixed';
      btn.style.left = newX + 'px';
      btn.style.top = newY + 'px';
      btn.style.zIndex = '50';
      btn.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;

      // Mostra messaggio scherzoso
      if (noAttempts >= 2) {
        chaseMessage.style.opacity = '1';
      }

      // Cambia testo del pulsante con messaggio casuale
      btn.textContent = getRandomNoMessage();
    }

    // Event listeners per il pulsante No
    noBtn.addEventListener('mouseenter', escapeNoButton);
    noBtn.addEventListener('touchstart', escapeNoButton, { passive: true });
    noBtn.addEventListener('click', (e) => {
      e.preventDefault();
      escapeNoButton(e);
    });

    // Funzione per creare confetti
    function createConfetti() {
      const colors = ['#f43f5e', '#ec4899', '#be123c', '#fda4af', '#fb7185', '#fecdd3'];
      const shapes = ['â¤ï¸', 'ğŸ’•', 'ğŸ’–', 'âœ¨', 'ğŸ’—', 'ğŸŒ¸'];
      
      for (let i = 0; i < 30; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti absolute text-2xl';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.top = '-10%';
          confetti.style.animationDuration = (2 + Math.random() * 2) + 's';
          confetti.style.animationDelay = Math.random() * 0.5 + 's';
          confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
          confettiContainer.appendChild(confetti);
          
          // Rimuovi dopo animazione
          setTimeout(() => confetti.remove(), 5000);
        }, i * 100);
      }
    }

    // Click su SÃ¬
    yesBtn.addEventListener('click', () => {
      questionPage.classList.add('hidden');
      questionPage.style.display = 'none';
      successPage.classList.remove('hidden');
      successPage.style.display = 'flex';
      createConfetti();
    });

    // Pulsante segreto
    secretBtn.addEventListener('click', () => {
      secretMessage.classList.toggle('hidden');
      if (!secretMessage.classList.contains('hidden')) {
        secretMessage.style.animation = 'float 0.5s ease-out';
      }
    });

    // Funzione per aggiornare l'UI basandosi sulla config
    async function onConfigChange(cfg) {
      // Aggiorna testi
      document.getElementById('main-question').textContent = cfg.main_question || defaultConfig.main_question;
      document.getElementById('success-title').textContent = cfg.success_title || defaultConfig.success_title;
      document.getElementById('success-message').textContent = cfg.success_message || defaultConfig.success_message;
      document.getElementById('dinner-message').textContent = cfg.dinner_message || defaultConfig.dinner_message;

      // Aggiorna colori
      const primaryColor = cfg.primary_color || defaultConfig.primary_color;
      const secondaryColor = cfg.secondary_color || defaultConfig.secondary_color;
      const backgroundColor = cfg.background_color || defaultConfig.background_color;
      const textColor = cfg.text_color || defaultConfig.text_color;
      const accentColor = cfg.accent_color || defaultConfig.accent_color;

      // Applica colori agli elementi
      document.getElementById('main-question').style.color = primaryColor;
      document.getElementById('success-title').style.color = primaryColor;
      document.getElementById('success-message').style.color = textColor;
      document.getElementById('dinner-message').style.color = primaryColor;
      document.getElementById('chase-message').style.color = primaryColor;

      // Pulsanti
      yesBtn.style.background = `linear-gradient(135deg, ${secondaryColor} 0%, ${primaryColor} 100%)`;
      noBtn.style.background = `linear-gradient(135deg, ${accentColor} 0%, ${secondaryColor} 100%)`;

      // Background pages
      questionPage.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${accentColor}33 50%, ${accentColor}66 100%)`;
      successPage.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${accentColor}33 50%, ${accentColor}66 100%)`;

      // Font
      const fontFamily = cfg.font_family || defaultConfig.font_family;
      const baseSize = cfg.font_size || defaultConfig.font_size;
      
      document.getElementById('main-question').style.fontFamily = `${fontFamily}, Playfair Display, serif`;
      document.getElementById('success-title').style.fontFamily = `${fontFamily}, Playfair Display, serif`;
      document.getElementById('main-question').style.fontSize = `${baseSize * 2}px`;
      document.getElementById('success-title').style.fontSize = `${baseSize * 2.5}px`;
      document.getElementById('success-message').style.fontSize = `${baseSize * 1.25}px`;
      document.getElementById('dinner-message').style.fontSize = `${baseSize * 1.125}px`;
    }

    // Inizializza SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (cfg) => ({
          recolorables: [
            {
              get: () => cfg.background_color || defaultConfig.background_color,
              set: (value) => { cfg.background_color = value; window.elementSdk.setConfig({ background_color: value }); }
            },
            {
              get: () => cfg.accent_color || defaultConfig.accent_color,
              set: (value) => { cfg.accent_color = value; window.elementSdk.setConfig({ accent_color: value }); }
            },
            {
              get: () => cfg.text_color || defaultConfig.text_color,
              set: (value) => { cfg.text_color = value; window.elementSdk.setConfig({ text_color: value }); }
            },
            {
              get: () => cfg.primary_color || defaultConfig.primary_color,
              set: (value) => { cfg.primary_color = value; window.elementSdk.setConfig({ primary_color: value }); }
            },
            {
              get: () => cfg.secondary_color || defaultConfig.secondary_color,
              set: (value) => { cfg.secondary_color = value; window.elementSdk.setConfig({ secondary_color: value }); }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => cfg.font_family || defaultConfig.font_family,
            set: (value) => { cfg.font_family = value; window.elementSdk.setConfig({ font_family: value }); }
          },
          fontSizeable: {
            get: () => cfg.font_size || defaultConfig.font_size,
            set: (value) => { cfg.font_size = value; window.elementSdk.setConfig({ font_size: value }); }
          }
        }),
        mapToEditPanelValues: (cfg) => new Map([
          ["main_question", cfg.main_question || defaultConfig.main_question],
          ["success_title", cfg.success_title || defaultConfig.success_title],
          ["success_message", cfg.success_message || defaultConfig.success_message],
          ["dinner_message", cfg.dinner_message || defaultConfig.dinner_message]
        ])
      });
    } else {
      // Fallback se SDK non disponibile
      onConfigChange(defaultConfig);
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cdbb7700487f671',t:'MTc3MTA2MzIwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
